<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Working with Tensors
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="Deep.Net machine learning framework"/>
    <meta name="author" content="Deep.Net developers"/>

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"/>

    <link type="text/css" rel="stylesheet" href="http://www.deepml.net/content/style.css" />
    <script type="text/javascript" src="http://www.deepml.net/content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <![endif]-->

    <script type="text/javascript" async
              src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://github.com/DeepMLNet/DeepNet">github page</a></li>
        </ul>
        <h3 class="muted"><a href="http://www.deepml.net/index.html">Deep.Net</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<h1><a name="Working-with-Tensors" class="anchor" href="#Working-with-Tensors">Working with Tensors</a></h1>
<p>In Deep.Net a <em>tensor</em> is an n-dimensional array of an arbitrary data type (for example <code>single</code>, <code>double</code> or <code>System.Numerics.Complex</code>).
Tensors are implemented by the <code>ArrayNDT&lt;'T&gt;</code> class and its derivatives <code>ArrayNDHostT</code> (for tensors stored in host memory) and <code>ArrayNDCudaT</code> (for tensors stored in CUDA GPU memory).
The Deep.Net tensor provides functionality similar to <a href="http://docs.scipy.org/doc/numpy-1.10.0/reference/arrays.html">Numpy's Ndarray</a> and <a href="http://www.mathworks.com/help/matlab/matrices-and-arrays.html">MATLAB arrays</a>, including vector-wise operations, reshaping, slicing, broadcasting, masked assignment, reduction operations and BLAS operations.
The API for host and GPU stored tensors is equal, thus a program can make use of GPU accelerated operations without much porting effort.</p>
<p>You can run this example by executing <code>FsiAnyCPU.exe docs\content\tensor.fsx</code> after cloning the Deep.Net repository.
You can move your mouse over any symbol in the code samples to see the full signature.</p>
<h2><a name="Architecture" class="anchor" href="#Architecture">Architecture</a></h2>
<p>To work with the tensor library, open the <code>ArrayNDNS</code> namespace.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span class="i">ArrayNDNS</span>
</code></pre></td>
</tr>
</table>
<p>The tensor library consists of three primary modules: ArrayND, ArrayNDHost, ArrayNDCuda.
ArrayND contains functions to work with existing tensors (regardless of their storage location) such as <code>reshape</code>, <code>sum</code>, and <code>copy</code>.
ArrayNDHost contains functions to create new tensors in host memory, for example <code>zeros</code>, <code>ones</code> and <code>ofList</code>.
ArrayNDCuda contains functions to create new tensors in CUDA GPU memory and to facilitate the transfer of tensors between host and GPU memory, for example <code>zeros</code>, <code>toDev</code> and <code>fromDev</code>.</p>
<h2><a name="Creating-tensors" class="anchor" href="#Creating-tensors">Creating tensors</a></h2>
<p>Let us create a simple <span class="math">\(7 \times 5\)</span> matrix, i.e. two-dimensional tensor, in host memory.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">a</span> <span class="o">=</span> <span class="i">ArrayNDHost</span><span class="o">.</span><span class="i">initIndexed</span> [<span class="n">7</span>; <span class="n">5</span>] (<span class="k">fun</span> [<span class="i">y</span>; <span class="i">x</span>] <span class="k">-&gt;</span> <span class="n">5.0</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">float</span> <span class="i">y</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs2', 3)" onmouseover="showTip(event, 'fs2', 3)" class="i">float</span> <span class="i">x</span>)
</code></pre></td>
</tr>
</table>
<p>The first argument to the <code>ArrayNDHost.initIndexed</code> function is an <a href="https://en.wikibooks.org/wiki/F_Sharp_Programming/Lists">F# list</a> specifies the shape of the tensor.
The second argument is a function that takes the n-dimensional index (zero-based) of an entry and computes its initial value; here we use the formula <span class="math">\(5y + x\)</span> where <span class="math">\(y\)</span> is the row and <span class="math">\(x\)</span> is the column of the matrix.
The data type (here float) is automatically inferred from the return type of the initialization function.
By default row-major storage (C storage order) is used.</p>
<p>The resulting tensor has the following entries.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp">[[   <span class="n">0.0000</span>    <span class="n">1.0000</span>    <span class="n">2.0000</span>    <span class="n">3.0000</span>    <span class="n">4.0000</span>]
 [   <span class="n">5.0000</span>    <span class="n">6.0000</span>    <span class="n">7.0000</span>    <span class="n">8.0000</span>    <span class="n">9.0000</span>]
 [  <span class="n">10.0000</span>   <span class="n">11.0000</span>   <span class="n">12.0000</span>   <span class="n">13.0000</span>   <span class="n">14.0000</span>]
 [  <span class="n">15.0000</span>   <span class="n">16.0000</span>   <span class="n">17.0000</span>   <span class="n">18.0000</span>   <span class="n">19.0000</span>]
 [  <span class="n">20.0000</span>   <span class="n">21.0000</span>   <span class="n">22.0000</span>   <span class="n">23.0000</span>   <span class="n">24.0000</span>]
 [  <span class="n">25.0000</span>   <span class="n">26.0000</span>   <span class="n">27.0000</span>   <span class="n">28.0000</span>   <span class="n">29.0000</span>]
 [  <span class="n">30.0000</span>   <span class="n">31.0000</span>   <span class="n">32.0000</span>   <span class="n">33.0000</span>   <span class="n">34.0000</span>]]
</code></pre></td>
</tr>
</table>
<p>We can also create a tensor filled with zeros using the <code>ArrayNDHost.zeros</code> function.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 4)" onmouseover="showTip(event, 'fs3', 4)" class="i">z1</span> <span class="o">:</span> <span class="i">ArrayNDHostT</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs4', 5)" onmouseover="showTip(event, 'fs4', 5)" class="i">int</span><span class="o">&gt;</span> <span class="o">=</span> <span class="i">ArrayNDHost</span><span class="o">.</span><span class="i">zeros</span> [<span class="n">3</span>]
</code></pre></td>
</tr>
</table>
<p>In this case we must specify the data type (int) explicitly, since there is no information in the function call to infer it automatically.</p>
<p>We can use the <code>ArrayNDHost.ones</code> function to obtain a tensor filled with ones.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs5', 6)" onmouseover="showTip(event, 'fs5', 6)" class="i">o1</span> <span class="o">:</span> <span class="i">ArrayNDHostT</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs6', 7)" onmouseover="showTip(event, 'fs6', 7)" class="i">single</span><span class="o">&gt;</span> <span class="o">=</span> <span class="i">ArrayNDHost</span><span class="o">.</span><span class="i">ones</span> [<span class="n">3</span>]
</code></pre></td>
</tr>
</table>
<p>The <code>ArrayNDHost.identity</code> function creates an identity matrix of the given size.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs7', 8)" onmouseover="showTip(event, 'fs7', 8)" class="i">id1</span> <span class="o">:</span> <span class="i">ArrayNDHostT</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs2', 9)" onmouseover="showTip(event, 'fs2', 9)" class="i">float</span><span class="o">&gt;</span> <span class="o">=</span> <span class="i">ArrayNDHost</span><span class="o">.</span><span class="i">identity</span> <span class="n">6</span>
</code></pre></td>
</tr>
</table>
<p>This created a <span class="math">\(6 \times 6\)</span> identity matrix.</p>
<p>A tensor of rank zero can be created with the <code>ArrayNDHost.scalar</code> function.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs8', 10)" onmouseover="showTip(event, 'fs8', 10)" class="i">s1</span> <span class="o">=</span> <span class="i">ArrayNDHost</span><span class="o">.</span><span class="i">scalar</span> <span class="n">33.2</span>
</code></pre></td>
</tr>
</table>
<p>The numeric value of a zero-rank tensor can be extracted using the <code>ArrayND.value</code> function.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs9', 11)" onmouseover="showTip(event, 'fs9', 11)" class="f">printfn</span> <span class="s">&quot;The numeric value of s1 is </span><span class="pf">%f</span><span class="s">.&quot;</span> (<span class="i">ArrayND</span><span class="o">.</span><span class="i">value</span> <span onmouseout="hideTip(event, 'fs8', 12)" onmouseover="showTip(event, 'fs8', 12)" class="i">s1</span>)
</code></pre></td>
</tr>
</table>
<h2><a name="Printing-tensors" class="anchor" href="#Printing-tensors">Printing tensors</a></h2>
<p>Tensors can be printed using the <code>%A</code> format specifier of the standard <code>printf</code> function.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs9', 13)" onmouseover="showTip(event, 'fs9', 13)" class="f">printfn</span> <span class="s">&quot;The tensor a is</span><span class="e">\n</span><span class="s"></span><span class="pf">%A</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs1', 14)" onmouseover="showTip(event, 'fs1', 14)" class="i">a</span>
<span onmouseout="hideTip(event, 'fs9', 15)" onmouseover="showTip(event, 'fs9', 15)" class="f">printfn</span> <span class="s">&quot;The tensor z1 is</span><span class="e">\n</span><span class="s"></span><span class="pf">%A</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs3', 16)" onmouseover="showTip(event, 'fs3', 16)" class="i">z1</span>
<span onmouseout="hideTip(event, 'fs9', 17)" onmouseover="showTip(event, 'fs9', 17)" class="f">printfn</span> <span class="s">&quot;The tensor o1 is</span><span class="e">\n</span><span class="s"></span><span class="pf">%A</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs5', 18)" onmouseover="showTip(event, 'fs5', 18)" class="i">o1</span>
<span onmouseout="hideTip(event, 'fs9', 19)" onmouseover="showTip(event, 'fs9', 19)" class="f">printfn</span> <span class="s">&quot;The tensor id1 is</span><span class="e">\n</span><span class="s"></span><span class="pf">%A</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs7', 20)" onmouseover="showTip(event, 'fs7', 20)" class="i">id1</span>
</code></pre></td>
</tr>
</table>
<p>The output of large tensors is automatically truncated to a reasonable size.</p>
<h2><a name="Accessing-elements" class="anchor" href="#Accessing-elements">Accessing elements</a></h2>
<p>Individual elements of a tensor can be accessed using the <code>tensor.[[idx0; idx1; ...; idxN]]</code> notation.
Zero-based indexing is used.
For example</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs1', 21)" onmouseover="showTip(event, 'fs1', 21)" class="i">a</span><span class="o">.</span>[[<span class="n">1</span>; <span class="n">1</span>]]
</code></pre></td>
</tr>
</table>
<p>accesses the element at index <span class="math">\(1,1\)</span> and returns <code>5.0</code>.
Note that the indices are specified with double brackets ([[ and ]]) and separated using a semicolon.</p>
<p>Tensors are mutable objects.
An element can be changed using the <code>tensor.[[idx0; idx1; ...; idxN]] &lt;- newValue</code> notation.
For example</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs1', 22)" onmouseover="showTip(event, 'fs1', 22)" class="i">a</span><span class="o">.</span>[[<span class="n">2</span>; <span class="n">2</span>]] <span class="o">&lt;-</span> <span class="n">55.</span>
</code></pre></td>
</tr>
</table>
<p>changes the tensor to</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp">[[   <span class="n">0.0000</span>    <span class="n">1.0000</span>    <span class="n">2.0000</span>    <span class="n">3.0000</span>    <span class="n">4.0000</span>]
 [   <span class="n">5.0000</span>    <span class="n">6.0000</span>    <span class="n">7.0000</span>    <span class="n">8.0000</span>    <span class="n">9.0000</span>]
 [  <span class="n">10.0000</span>   <span class="n">11.0000</span>   <span class="n">55.0000</span>   <span class="n">13.0000</span>   <span class="n">14.0000</span>]
 [  <span class="n">15.0000</span>   <span class="n">16.0000</span>   <span class="n">17.0000</span>   <span class="n">18.0000</span>   <span class="n">19.0000</span>]
 [  <span class="n">20.0000</span>   <span class="n">21.0000</span>   <span class="n">22.0000</span>   <span class="n">23.0000</span>   <span class="n">24.0000</span>]
 [  <span class="n">25.0000</span>   <span class="n">26.0000</span>   <span class="n">27.0000</span>   <span class="n">28.0000</span>   <span class="n">29.0000</span>]
 [  <span class="n">30.0000</span>   <span class="n">31.0000</span>   <span class="n">32.0000</span>   <span class="n">33.0000</span>   <span class="n">34.0000</span>]]
</code></pre></td>
</tr>
</table>
<h2><a name="Slicing" class="anchor" href="#Slicing">Slicing</a></h2>
<p>Slicing creates a new view into an existing tensor.
Slicing is done using the <code>tensor.[rng0, rng1, ..., rngN]</code> notation.
Note that the ranges are specified within single brackets and separated using commas.</p>
<p>Let us select the first row of tensor a.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs10', 23)" onmouseover="showTip(event, 'fs10', 23)" class="i">a1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs1', 24)" onmouseover="showTip(event, 'fs1', 24)" class="i">a</span><span class="o">.</span>[<span class="n">0</span>, <span class="o">*</span>]
</code></pre></td>
</tr>
</table>
<p>The asterisk selects all elements of the specified dimension.
The result is a tensor of rank one (i.e. a vector) with the entries</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp">[   <span class="n">0.0000</span>    <span class="n">1.0000</span>    <span class="n">2.0000</span>    <span class="n">3.0000</span>    <span class="n">4.0000</span>]
</code></pre></td>
</tr>
</table>
<p>Since <code>a1</code> is a view of <code>a</code> it shares the same memory.
Changing an element of <code>a1</code> by assigning a new value to it</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs10', 25)" onmouseover="showTip(event, 'fs10', 25)" class="i">a1</span><span class="o">.</span>[[<span class="n">1</span>]] <span class="o">&lt;-</span> <span class="n">99.</span>
</code></pre></td>
</tr>
</table>
<p>changes the tensor <code>a</code> as well.
This can be seen by outputting <code>a1</code> and <code>a</code>.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs9', 26)" onmouseover="showTip(event, 'fs9', 26)" class="f">printfn</span> <span class="s">&quot;a1 is now</span><span class="e">\n</span><span class="s"></span><span class="pf">%A</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs10', 27)" onmouseover="showTip(event, 'fs10', 27)" class="i">a1</span>
<span onmouseout="hideTip(event, 'fs9', 28)" onmouseover="showTip(event, 'fs9', 28)" class="f">printfn</span> <span class="s">&quot;a is now</span><span class="e">\n</span><span class="s"></span><span class="pf">%A</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs1', 29)" onmouseover="showTip(event, 'fs1', 29)" class="i">a</span>
</code></pre></td>
</tr>
</table>
<p>The corresponding output is</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="i">a1</span> <span class="i">is</span> <span class="i">now</span>
[   <span class="n">0.0000</span>   <span class="n">99.0000</span>    <span class="n">2.0000</span>    <span class="n">3.0000</span>    <span class="n">4.0000</span>]
<span class="i">a</span> <span class="i">is</span> <span class="i">now</span>
[[   <span class="n">0.0000</span>   <span class="n">99.0000</span>    <span class="n">2.0000</span>    <span class="n">3.0000</span>    <span class="n">4.0000</span>]
 [   <span class="n">5.0000</span>    <span class="n">6.0000</span>    <span class="n">7.0000</span>    <span class="n">8.0000</span>    <span class="n">9.0000</span>]
 [  <span class="n">10.0000</span>   <span class="n">11.0000</span>   <span class="n">55.0000</span>   <span class="n">13.0000</span>   <span class="n">14.0000</span>]
 [  <span class="n">15.0000</span>   <span class="n">16.0000</span>   <span class="n">17.0000</span>   <span class="n">18.0000</span>   <span class="n">19.0000</span>]
 [  <span class="n">20.0000</span>   <span class="n">21.0000</span>   <span class="n">22.0000</span>   <span class="n">23.0000</span>   <span class="n">24.0000</span>]
 [  <span class="n">25.0000</span>   <span class="n">26.0000</span>   <span class="n">27.0000</span>   <span class="n">28.0000</span>   <span class="n">29.0000</span>]
 [  <span class="n">30.0000</span>   <span class="n">31.0000</span>   <span class="n">32.0000</span>   <span class="n">33.0000</span>   <span class="n">34.0000</span>]]
</code></pre></td>
</tr>
</table>
<p>The slicing notation can also be used for changing multiple elements of a tensor at once.
For example</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs11', 30)" onmouseover="showTip(event, 'fs11', 30)" class="i">a2</span> <span class="o">:</span> <span class="i">ArrayNDHostT</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs2', 31)" onmouseover="showTip(event, 'fs2', 31)" class="i">float</span><span class="o">&gt;</span> <span class="o">=</span> <span class="i">ArrayNDHost</span><span class="o">.</span><span class="i">ones</span> [<span class="n">5</span>] 
<span onmouseout="hideTip(event, 'fs1', 32)" onmouseover="showTip(event, 'fs1', 32)" class="i">a</span><span class="o">.</span>[<span class="n">0</span>, <span class="o">*</span>] <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs11', 33)" onmouseover="showTip(event, 'fs11', 33)" class="i">a2</span>
</code></pre></td>
</tr>
</table>
<p>sets all elements of the first row of <code>a</code> to 1.
The tensor <code>a</code> is now</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp">[[   <span class="n">1.0000</span>    <span class="n">1.0000</span>    <span class="n">1.0000</span>    <span class="n">1.0000</span>    <span class="n">1.0000</span>]
 [   <span class="n">5.0000</span>    <span class="n">6.0000</span>    <span class="n">7.0000</span>    <span class="n">8.0000</span>    <span class="n">9.0000</span>]
 [  <span class="n">10.0000</span>   <span class="n">11.0000</span>   <span class="n">55.0000</span>   <span class="n">13.0000</span>   <span class="n">14.0000</span>]
 [  <span class="n">15.0000</span>   <span class="n">16.0000</span>   <span class="n">17.0000</span>   <span class="n">18.0000</span>   <span class="n">19.0000</span>]
 [  <span class="n">20.0000</span>   <span class="n">21.0000</span>   <span class="n">22.0000</span>   <span class="n">23.0000</span>   <span class="n">24.0000</span>]
 [  <span class="n">25.0000</span>   <span class="n">26.0000</span>   <span class="n">27.0000</span>   <span class="n">28.0000</span>   <span class="n">29.0000</span>]
 [  <span class="n">30.0000</span>   <span class="n">31.0000</span>   <span class="n">32.0000</span>   <span class="n">33.0000</span>   <span class="n">34.0000</span>]]
</code></pre></td>
</tr>
</table>
<h3><a name="Slicing-operations" class="anchor" href="#Slicing-operations">Slicing operations</a></h3>
<p>Consider the two-dimensional tensor <code>a</code> of shape <span class="math">\(7 \times 5\)</span> and the four-dimensional tensor <code>b</code> of shape <span class="math">\(1 \times 2 \times 3 \times 4\)</span>.
A slice range can be one of the following.</p>
<ul>
<li>A range, e.g. <code>1..3</code>. Selects the specified elements in the corresponding dimension. For example <code>a.[1..3, 0..2]</code> is the <span class="math">\(3 \times 3\)</span> sub-tensor of <code>a</code> containing rows 1, 2, 3 and columns 0, 1, 2. <strong>The ending index is inclusive.</strong></li>
<li>A partial range, e.g. <code>1..</code> or <code>..3</code>. This selects all elements in the corresponding dimension to the end or from the beginning respectively. Thus <code>a.[1.., ..3]</code> is equivalent to <code>a.[1..6, 0..3]</code>.</li>
<li>An asterisk <code>*</code>. Selects all elements in the corresponding dimension. For example <code>a.[1..3, *]</code> is equivalent to <code>a.[1..3, 0..4]</code>.</li>
<li>An integer. The corresponding dimension collapses, e.g. <code>a.[*, 0]</code> specifies a one-dimensional tensor of shape <span class="math">\(7\)</span> corresponding to the first column of <code>a</code>.</li>
<li>The special identifier <code>NewAxis</code>. It inserts a new axis of size one at the given position. For example <code>a.[*, NewAxis, *]</code> produces a view of shape <span class="math">\(7 \times 1 \times 5\)</span>.</li>
<li>The special identifier <code>Fill</code>. It fills any dimensions not specified (if any) with an asterisk <code>*</code>. For example <code>b.[0, Fill, 2]</code> is equivalent to <code>b.[0, *, *, 4]</code> and results into a two-dimensional view into tensor <code>b</code>.</li>
</ul>
<p>All slice range operators can be combined arbitrarily.</p>
<p>The reader should note that the result of selecting a single element using the slicing operator, e.g. <span class="math">\(a.[1,1]\)</span>, is a <em>tensor</em> of dimension zero sharing the same memory as <code>a</code>.</p>
<h2><a name="Shape-operations" class="anchor" href="#Shape-operations">Shape operations</a></h2>
<h3><a name="Getting-the-shape" class="anchor" href="#Getting-the-shape">Getting the shape</a></h3>
<p>The shape of a tensor can be accessed using the function <code>ArrayND.shape</code> or using the <code>Shape</code> property.
Both methods return a list.
The rank (number of dimensions) can be accessed using the function <code>ArrayND.nDims</code> or with the <code>NDims</code> property.
The number of elements can be accessed using the function <code>ArrayND.nElems</code> or with the <code>NElems</code> property.
For example</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs9', 34)" onmouseover="showTip(event, 'fs9', 34)" class="f">printfn</span> <span class="s">&quot;a has shape </span><span class="pf">%A</span><span class="s">, rank </span><span class="pf">%d</span><span class="s"> and </span><span class="pf">%d</span><span class="s"> elements.&quot;</span> <span onmouseout="hideTip(event, 'fs1', 35)" onmouseover="showTip(event, 'fs1', 35)" class="i">a</span><span class="o">.</span><span class="i">Shape</span> <span onmouseout="hideTip(event, 'fs1', 36)" onmouseover="showTip(event, 'fs1', 36)" class="i">a</span><span class="o">.</span><span class="i">NDims</span> <span onmouseout="hideTip(event, 'fs1', 37)" onmouseover="showTip(event, 'fs1', 37)" class="i">a</span><span class="o">.</span><span class="i">NElems</span>
</code></pre></td>
</tr>
</table>
<p>prints</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="i">a</span> <span class="i">has</span> <span class="i">shape</span> [<span class="n">7</span>; <span class="n">5</span>], <span class="i">rank</span> <span class="n">2</span> <span class="k">and</span> <span class="n">35</span> <span class="i">elements</span><span class="o">.</span>
</code></pre></td>
</tr>
</table>
<h3><a name="Reshaping" class="anchor" href="#Reshaping">Reshaping</a></h3>
<p>Reshaping changes the shape of the tensor while keeping the number of elements constants.
Use the <code>ArrayND.reshape</code> function to create a new view of a tensor with a different shape.</p>

<div class="tip" id="fs1">val a : obj<br /><br />Full name: Tensor.a</div>
<div class="tip" id="fs2">Multiple items<br />val float : value:&#39;T -&gt; float (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.float<br /><br />--------------------<br />type float = System.Double<br /><br />Full name: Microsoft.FSharp.Core.float<br /><br />--------------------<br />type float&lt;&#39;Measure&gt; = float<br /><br />Full name: Microsoft.FSharp.Core.float&lt;_&gt;</div>
<div class="tip" id="fs3">val z1 : obj<br /><br />Full name: Tensor.z1</div>
<div class="tip" id="fs4">Multiple items<br />val int : value:&#39;T -&gt; int (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.int<br /><br />--------------------<br />type int = int32<br /><br />Full name: Microsoft.FSharp.Core.int<br /><br />--------------------<br />type int&lt;&#39;Measure&gt; = int<br /><br />Full name: Microsoft.FSharp.Core.int&lt;_&gt;</div>
<div class="tip" id="fs5">val o1 : obj<br /><br />Full name: Tensor.o1</div>
<div class="tip" id="fs6">Multiple items<br />val single : value:&#39;T -&gt; single (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.single<br /><br />--------------------<br />type single = System.Single<br /><br />Full name: Microsoft.FSharp.Core.single</div>
<div class="tip" id="fs7">val id1 : obj<br /><br />Full name: Tensor.id1</div>
<div class="tip" id="fs8">val s1 : obj<br /><br />Full name: Tensor.s1</div>
<div class="tip" id="fs9">val printfn : format:Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.printfn</div>
<div class="tip" id="fs10">val a1 : obj<br /><br />Full name: Tensor.a1</div>
<div class="tip" id="fs11">val a2 : obj<br /><br />Full name: Tensor.a2</div>

        </div>
        <div class="span3">
          <!-- <img src="http://www.deepml.net/img/logo.png" alt="Deep.Net logo" style="width:150px;margin:10px" /> -->  
          <ul class="nav nav-list" id="menu" style="margin-top: 20px;">
            <li class="nav-header">Deep.Net</li>
            <li><a href="http://www.deepml.net/index.html">Home page</a></li>
            <li class="divider"></li>
            <li><a href="http://nuget.org/packages/DeepNet">Get Library via NuGet</a></li>
            <li><a href="http://github.com/DeepMLNet/DeepNet">Source Code on GitHub</a></li>
            <li><a href="http://www.deepml.net/release-notes.html">Release Notes</a></li>
            
            <li class="nav-header">Getting started</li>
            <li><a href="http://www.deepml.net/tensor.html">Working with Tensors</a></li>
            <li><a href="http://www.deepml.net/mnist.html">Learning MNIST</a></li>

            <li class="nav-header">Documentation</li>
            <li><a href="http://www.deepml.net/reference/index.html">API Reference</a></li>
          </ul>
        </div>
      </div>
    </div>
    <a href="http://github.com/DeepMLNet/DeepNet"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"/></a>
  </body>
  </html>
