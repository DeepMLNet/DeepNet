-
  version: 0.4.0.{build}
  shallow_clone: true  
  image: Visual Studio 2017

  before_build:
    - dotnet --version
    - ps: Add-Content NuGet.Config '<?xml version="1.0" encoding="utf-8"?>' 
    - ps: Add-Content NuGet.Config '<configuration><packageSources>'
    - ps: Add-Content NuGet.Config '<add key="CorePorts" value="https://www.myget.org/F/coreports/api/v3/index.json" protocolVersion="3" />'
    - ps: Add-Content NuGet.Config '<add key="nuget.org" value="https://api.nuget.org/v3/index.json" protocolVersion="3" />'
    - ps: Add-Content NuGet.Config '</packageSources></configuration>'
#    - ps: Remove-Item Revision.targets
#    - ps: Add-Content Revision.targets "<Project><PropertyGroup><Rev>${env:APPVEYOR_BUILD_NUMBER}</Rev></PropertyGroup></Project>"
    - dotnet restore Tensor/Tensor.sln

  build_script:
    - dotnet build -c Release Tensor/Tensor.sln
  
  test_script:
    - dotnet test -c Release Tensor/Tensor.Test/Tensor.Test.fsproj 
  
  after_test:
    - dotnet pack -c Release Tensor/Tensor.sln

  artifacts:
    - path: Packages\Release\*.nupkg

